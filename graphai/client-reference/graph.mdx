---
sidebarTitle: graph
title: graphai.graph
---

## NodeProtocol Objects

```python
class NodeProtocol(Protocol)
```

Protocol defining the interface of a decorated node.

## Graph Objects

```python
class Graph()
```

#### get\_state

```python
def get_state() -> dict[str, Any]
```

Get the current graph state.

#### set\_state

```python
def set_state(state: dict[str, Any]) -> Graph
```

Set the graph state.

#### update\_state

```python
def update_state(values: dict[str, Any]) -> Graph
```

Update the graph state with new values.

#### reset\_state

```python
def reset_state() -> Graph
```

Reset the graph state to an empty dict.

#### add\_edge

```python
def add_edge(source: NodeProtocol | str,
             destination: NodeProtocol | str) -> Graph
```

Adds an edge between two nodes that already exist in the graph.

**Arguments**:

- `source` - The source node or its name.
- `destination` - The destination node or its name.

#### compile

```python
def compile(*, strict: bool = False) -> Graph
```

Validate the graph:
- exactly one start node present (or Graph.start_node set)
- at least one end node present
- all edges reference known nodes
- all nodes reachable from the start
  (optional) **no cycles** when strict=True
Returns self on success; raises GraphCompileError otherwise.

#### execute\_many

```python
async def execute_many(inputs: Iterable[dict[str, Any]],
                       *,
                       concurrency: int = 5) -> list[Any]
```

Execute the graph on many inputs concurrently.

**Arguments**:

- `inputs` (`Iterable[dict]`): An iterable of input dicts to feed into the graph.
- `concurrency` (`int`): Maximum number of graph executions to run at once.
- `state` (`Optional[Any]`): Optional shared state to pass to each execution.
If you want isolated state per execution, pass None
and the graph&#x27;s normal semantics will apply.

**Returns**:

`list[Any]`: The list of results in the same order as ``inputs``.

#### get\_callback

```python
def get_callback()
```

Get a new instance of the callback class.

**Returns**:

`Callback`: A new instance of the callback class.

#### set\_callback

```python
def set_callback(callback_class: type[Callback]) -> "Graph"
```

Set the callback class that is returned by the `get_callback` method and used

as the default callback when no callback is passed to the `execute` method.

**Arguments**:

- `callback_class` (`type[Callback]`): The callback class to use as the default callback.

#### visualize

```python
def visualize(*, save_path: str | None = None)
```

Render the current graph. If matplotlib is not installed,
raise a helpful error telling users to install the viz extra.
Optionally save to a file via `save_path`.

